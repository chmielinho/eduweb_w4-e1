(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var Point = (function () {
    function Point(x, y) {
        this.x = x;
        this.y = y;
    }
    Point.prototype.add = function (point) {
        this.x += point.x;
        this.y += point.y;
    };
    return Point;
}());
var Vector = (function (_super) {
    __extends(Vector, _super);
    function Vector() {
        _super.apply(this, arguments);
    }
    Vector.prototype.flipX = function () {
        this.x *= -1;
    };
    Vector.prototype.flipY = function () {
        this.y *= -1;
    };
    return Vector;
}(Point));
var Rect = (function () {
    function Rect(left, top, right, bottom) {
        this.topLeft = new Point(left, top);
        this.bottomRight = new Point(right, bottom);
    }
    Rect.prototype.clone = function () {
        return new Rect(this.topLeft.x, this.topLeft.y, this.bottomRight.x, this.bottomRight.y);
    };
    Rect.prototype.add = function (point) {
        this.topLeft.add(point);
        this.bottomRight.add(point);
    };
    Rect.prototype.moveTo = function (rect) {
        this.topLeft.x = rect.topLeft.x;
        this.topLeft.y = rect.topLeft.y;
        this.bottomRight.x = rect.bottomRight.x;
        this.bottomRight.y = rect.bottomRight.y;
    };
    Rect.prototype.moveCenterXTo = function (centerX) {
        var left = centerX - this.width() / 2;
        var right = left + this.width();
        this.topLeft.x = left;
        this.bottomRight.x = right;
    };
    Rect.prototype.moveBottomTo = function (bottom) {
        this.topLeft.y = bottom - this.height();
        this.bottomRight.y = bottom;
    };
    Rect.prototype.width = function () {
        return this.bottomRight.x - this.topLeft.x;
    };
    Rect.prototype.height = function () {
        return this.bottomRight.y - this.topLeft.y;
    };
    Rect.prototype.centerX = function () {
        return (this.topLeft.x + this.bottomRight.x) / 2;
    };
    Rect.prototype.centerY = function () {
        return (this.topLeft.y + this.bottomRight.y) / 2;
    };
    Rect.prototype.moveLeft = function (step) {
        this.topLeft.x -= step;
        this.bottomRight.x -= step;
    };
    Rect.prototype.moveRight = function (step) {
        this.topLeft.x += step;
        this.bottomRight.x += step;
    };
    return Rect;
}());
var Side;
(function (Side) {
    Side[Side["None"] = 0] = "None";
    Side[Side["Left"] = 1] = "Left";
    Side[Side["Top"] = 2] = "Top";
    Side[Side["Right"] = 3] = "Right";
    Side[Side["Bottom"] = 4] = "Bottom";
})(Side || (Side = {}));
var Obstacle = (function (_super) {
    __extends(Obstacle, _super);
    function Obstacle() {
        _super.apply(this, arguments);
    }
    Obstacle.prototype.checkCollision = function (anotherRect) {
        var w = 0.5 * (this.width() + anotherRect.width());
        var h = 0.5 * (this.height() + anotherRect.height());
        var dx = this.centerX() - anotherRect.centerX();
        var dy = this.centerY() - anotherRect.centerY();
        if (Math.abs(dx) <= w && Math.abs(dy) <= h) {
            var wy = w * dy;
            var hx = h * dx;
            if (wy > hx) {
                return wy > -hx ? Side.Top : Side.Left;
            }
            else {
                return wy > -hx ? Side.Right : Side.Bottom;
            }
        }
        else {
            return Side.None;
        }
    };
    return Obstacle;
}(Rect));
var Sprite = (function (_super) {
    __extends(Sprite, _super);
    function Sprite(sprite, left, top, right, bottom) {
        bottom = bottom || sprite.offsetTop + sprite.offsetHeight;
        right = right || sprite.offsetLeft + sprite.offsetWidth;
        top = top || sprite.offsetTop;
        left = left || sprite.offsetLeft;
        _super.call(this, left, top, right, bottom);
        this.sprite = sprite;
        this.isVisible = true;
    }
    Sprite.prototype.moveTo = function (rect) {
        _super.prototype.moveTo.call(this, rect);
        var _a = this.topLeft, posX = _a.x, posY = _a.y;
        this.sprite.style.left = posX + 'px';
        this.sprite.style.top = posY + 'px';
    };
    Sprite.prototype.hide = function () {
        this.sprite.style.display = 'none';
        this.isVisible = false;
    };
    Sprite.prototype.show = function () {
        this.sprite.style.display = 'block';
        this.isVisible = true;
    };
    Sprite.prototype.checkCollision = function (anotherRect) {
        if (!this.isVisible) {
            return Side.None;
        }
        return _super.prototype.checkCollision.call(this, anotherRect);
    };
    return Sprite;
}(Obstacle));
var Ball = (function (_super) {
    __extends(Ball, _super);
    function Ball(sprite, dir) {
        var radius = parseInt(getComputedStyle(sprite)['border-top-left-radius']);
        _super.call(this, sprite, sprite.offsetLeft, sprite.offsetTop, sprite.offsetLeft + 2 * radius, sprite.offsetTop + 2 * radius);
        this.sprite = sprite;
        this.radius = radius;
        this.velocity = 5;
        this.dir = dir;
    }
    Ball.prototype.calculateNewPosition = function () {
        var newPosition = this.clone();
        newPosition.add(this.dir);
        return newPosition;
    };
    Ball.prototype.bounceHorizontal = function () {
        this.dir.flipY();
    };
    Ball.prototype.bounceVertical = function () {
        this.dir.flipX();
    };
    Ball.prototype.bounceWithAngle = function (angle) {
        angle = angle * (Math.PI / 180);
        this.dir.x = Math.cos(angle) * this.velocity;
        this.dir.y = -Math.sin(angle) * this.velocity;
    };
    return Ball;
}(Sprite));
var Paddle = (function (_super) {
    __extends(Paddle, _super);
    function Paddle(sprite, maxRight) {
        _super.call(this, sprite);
        this.maxRight = maxRight;
    }
    Paddle.prototype.moveLeft = function (step) {
        var newPosition = this.clone();
        newPosition.moveLeft(step);
        if (newPosition.topLeft.x >= 0) {
            this.moveTo(newPosition);
        }
    };
    Paddle.prototype.moveRight = function (step) {
        var newPosition = this.clone();
        newPosition.moveRight(step);
        if (newPosition.bottomRight.x <= this.maxRight) {
            this.moveTo(newPosition);
        }
    };
    Paddle.prototype.calculateHitAngle = function (ballX, ballRadius) {
        var hitSpot = ballX - this.topLeft.x;
        var maxPaddle = this.width() + ballRadius;
        var minPaddle = -ballRadius;
        var paddleRange = maxPaddle - minPaddle;
        var minAngle = 160;
        var maxAngle = 20;
        var angleRange = maxAngle - minAngle;
        return ((hitSpot * angleRange) / paddleRange) + minAngle;
    };
    return Paddle;
}(Sprite));
var Brick = (function (_super) {
    __extends(Brick, _super);
    function Brick() {
        _super.apply(this, arguments);
        this.lifeLeft = 1;
    }
    return Brick;
}(Sprite));
var DoubleBrick = (function (_super) {
    __extends(DoubleBrick, _super);
    function DoubleBrick() {
        _super.apply(this, arguments);
        this.lifeLeft = 2;
    }
    DoubleBrick.prototype.oneLifeLeft = function () {
        this.sprite.classList.remove('doublebrick');
    };
    return DoubleBrick;
}(Sprite));
var GameState;
(function (GameState) {
    GameState[GameState["Running"] = 0] = "Running";
    GameState[GameState["GameOver"] = 1] = "GameOver";
})(GameState || (GameState = {}));
var KeyCodes;
(function (KeyCodes) {
    KeyCodes[KeyCodes["LEFT"] = 37] = "LEFT";
    KeyCodes[KeyCodes["RIGHT"] = 39] = "RIGHT";
})(KeyCodes || (KeyCodes = {}));
var Game = (function () {
    function Game(ballElement, paddle, bricks, boardElement, livesLabel, scoreLabel, newGameBtn) {
        var _this = this;
        this.livesLabel = livesLabel;
        this.scoreLabel = scoreLabel;
        this.newGameBtn = newGameBtn;
        this.loopInterval = 10;
        this.bricks = [];
        this.keyMap = {};
        this.gameState = GameState.Running;
        this.paddle = new Paddle(paddle, boardElement.offsetWidth);
        this.ball = new Ball(ballElement, new Vector(3, -3));
        for (var i = 0; i < bricks.length; i++) {
            if (bricks[i].classList.contains('doublebrick')) {
                this.bricks.push(new DoubleBrick(bricks[i]));
            }
            else {
                this.bricks.push(new Brick(bricks[i]));
            }
        }
        this.createWalls(this.ball.radius, boardElement.offsetWidth, boardElement.offsetHeight);
        this.newGame();
        this.newGameBtn.addEventListener('click', function () { return _this.newGame(); });
    }
    Game.prototype.createWalls = function (radius, maxX, maxY) {
        this.wallLeft = new Obstacle(-radius, -radius, 0, maxY + radius);
        this.wallTop = new Obstacle(-radius, -radius, maxX + radius, 0);
        this.wallRight = new Obstacle(maxX, -radius, maxX + radius, maxY + radius);
        this.wallBottom = new Obstacle(-radius, maxY, maxX + radius, maxY + radius);
    };
    Game.prototype.newGame = function () {
        this.newGameBtn.style.display = 'none';
        this.score = 0;
        this.livesLeft = 3;
        this.livesLabel.innerText = '' + this.livesLeft;
        this.score = 0;
        this.scoreLabel.innerText = '' + this.score;
        this.ball.show();
        this.ball.bounceWithAngle(60);
        var ballPosition = this.ball.clone();
        ballPosition.moveCenterXTo(this.paddle.centerX());
        ballPosition.moveBottomTo(this.paddle.topLeft.y - 4);
        this.ball.moveTo(ballPosition);
        this.gameState = GameState.Running;
    };
    Game.prototype.lostLive = function () {
        if (--this.livesLeft) {
            this.ball.bounceWithAngle(60);
            var ballPosition = this.ball.clone();
            ballPosition.moveCenterXTo(this.paddle.centerX());
            ballPosition.moveBottomTo(this.paddle.topLeft.y - 4);
            this.ball.moveTo(ballPosition);
        }
        else {
            this.gameState = GameState.GameOver;
            this.ball.hide();
            this.newGameBtn.style.display = 'block';
        }
        this.livesLabel.innerText = '' + this.livesLeft;
    };
    Game.prototype.run = function () {
        var _this = this;
        document.addEventListener('keyup', function (e) { return _this.keyMap[e.keyCode] = false; });
        document.addEventListener('keydown', function (e) { return _this.keyMap[e.keyCode] = true; });
        setInterval(function () {
            if (_this.gameState !== GameState.Running) {
                return;
            }
            var newBallPosition = _this.ball.calculateNewPosition();
            if (_this.keyMap[KeyCodes.LEFT]) {
                _this.paddle.moveLeft(5);
            }
            else if (_this.keyMap[KeyCodes.RIGHT]) {
                _this.paddle.moveRight(5);
            }
            if (_this.wallBottom.checkCollision(newBallPosition)) {
                _this.lostLive();
                return;
            }
            if (_this.wallLeft.checkCollision(newBallPosition) || _this.wallRight.checkCollision(newBallPosition)) {
                _this.ball.bounceVertical();
            }
            if (_this.wallTop.checkCollision(newBallPosition)) {
                _this.ball.bounceHorizontal();
            }
            for (var _i = 0, _a = _this.bricks; _i < _a.length; _i++) {
                var brick = _a[_i];
                var wasHit = false;
                switch (brick.checkCollision(newBallPosition)) {
                    case (Side.Left):
                    case (Side.Right):
                        _this.ball.bounceVertical();
                        wasHit = true;
                        break;
                    case (Side.Top):
                    case (Side.Bottom):
                        _this.ball.bounceHorizontal();
                        wasHit = true;
                }
                if (wasHit) {
                    if (--brick.lifeLeft < 1) {
                        brick.hide();
                    }
                    else {
                        brick.oneLifeLeft();
                    }
                    _this.score += 20;
                    _this.scoreLabel.innerText = '' + _this.score;
                    break;
                }
            }
            if (_this.paddle.checkCollision(newBallPosition)) {
                _this.ball.bounceWithAngle(_this.paddle.calculateHitAngle(_this.ball.centerX(), _this.ball.radius));
            }
            _this.ball.moveTo(_this.ball.calculateNewPosition());
        }, this.loopInterval);
    };
    return Game;
}());
console.log('Hello from BrickBuster !!!');
var game = new Game(document.getElementsByClassName("ball")[0], document.getElementsByClassName("paddle")[0], document.getElementsByClassName("brick"), document.getElementsByClassName("game-board")[0], document.getElementById('lives'), document.getElementById('score'), document.getElementById('newGame'));
game.run();
},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHBsaWNhdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0FDQUE7SUFHSSxlQUFZLENBQVUsRUFBRSxDQUFTO1FBQzdCLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ1gsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDZixDQUFDO0lBRUQsbUJBQUcsR0FBSCxVQUFJLEtBQVk7UUFDWixJQUFJLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDbEIsSUFBSSxDQUFDLENBQUMsSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ3RCLENBQUM7SUFDTCxZQUFDO0FBQUQsQ0FaQSxBQVlDLElBQUE7QUFFRDtJQUFxQiwwQkFBSztJQUExQjtRQUFxQiw4QkFBSztJQVExQixDQUFDO0lBUEcsc0JBQUssR0FBTDtRQUNJLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDakIsQ0FBQztJQUVELHNCQUFLLEdBQUw7UUFDSSxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ2pCLENBQUM7SUFDTCxhQUFDO0FBQUQsQ0FSQSxBQVFDLENBUm9CLEtBQUssR0FRekI7QUFFRDtJQUlJLGNBQVksSUFBYSxFQUFFLEdBQVcsRUFBRSxLQUFhLEVBQUUsTUFBYztRQUNqRSxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksS0FBSyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNwQyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksS0FBSyxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNoRCxDQUFDO0lBRUQsb0JBQUssR0FBTDtRQUNJLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLENB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LENBQUMsQ0FBQztnQkFDOUMsS0FBSSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxLQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUFFLEtBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztZQUNwRyxDQUFDO1lBRUQsS0FBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSSxDQUFDLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDLENBQUM7UUFDeEQsQ0FBQyxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQTtJQUN4QixDQUFDO0lBQ0wsV0FBQztBQUFELENBakpBLEFBaUpDLElBQUE7QUFFRCxPQUFPLENBQUMsR0FBRyxDQUFDLDRCQUE0QixDQUFDLENBQUM7QUFFMUMsSUFBSSxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQ0YsUUFBUSxDQUFDLHNCQUFzQixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUMxQyxRQUFRLENBQUMsc0JBQXNCLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQ3pDLFFBQVEsQ0FBQyxzQkFBc0IsQ0FBQyxPQUFPLENBQUMsRUFDM0MsUUFBUSxDQUFDLHNCQUFzQixDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUNoRCxRQUFRLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxFQUNoQyxRQUFRLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxFQUNoQyxRQUFRLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUNsRCxDQUFDO0FBRUYsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImNsYXNzIFBvaW50IHtcbiAgICB4OiBudW1iZXI7XG4gICAgeTogbnVtYmVyO1xuICAgIGNvbnN0cnVjdG9yKHggOiBudW1iZXIsIHk6IG51bWJlcikge1xuICAgICAgICB0aGlzLnggPSB4O1xuICAgICAgICB0aGlzLnkgPSB5O1xuICAgIH1cblxuICAgIGFkZChwb2ludDogUG9pbnQpIHtcbiAgICAgICAgdGhpcy54ICs9IHBvaW50Lng7XG4gICAgICAgIHRoaXMueSArPSBwb2ludC55O1xuICAgIH1cbn1cblxuY2xhc3MgVmVjdG9yIGV4dGVuZHMgUG9pbnQge1xuICAgIGZsaXBYKCkge1xuICAgICAgICB0aGlzLnggKj0gLTE7XG4gICAgfVxuXG4gICAgZmxpcFkoKSB7XG4gICAgICAgIHRoaXMueSAqPSAtMTtcbiAgICB9XG59XG5cbmNsYXNzIFJlY3Qge1xuICAgIHRvcExlZnQgOiBQb2ludDtcbiAgICBib3R0b21SaWdodCA6IFBvaW50O1xuXG4gICAgY29uc3RydWN0b3IobGVmdCA6IG51bWJlciwgdG9wOiBudW1iZXIsIHJpZ2h0OiBudW1iZXIsIGJvdHRvbTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMudG9wTGVmdCA9IG5ldyBQb2ludChsZWZ0LCB0b3ApO1xuICAgICAgICB0aGlzLmJvdHRvbVJpZ2h0ID0gbmV3IFBvaW50KHJpZ2h0LCBib3R0b20pO1xuICAgIH1cblxuICAgIGNsb25lKCkgOiBSZWN0IHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWN0KHRoaXMudG9wTGVmdC54LCB0aGlzLnRvcExlZnQueSwgdGhpcy5ib3R0b21SaWdodC54LCB0aGlzLmJvdHRvbVJpZ2h0LnkpO1xuICAgIH1cblxuICAgIGFkZChwb2ludDogUG9pbnQpIHtcbiAgICAgICAgdGhpcy50b3BMZWZ0LmFkZChwb2ludCk7XG4gICAgICAgIHRoaXMuYm90dG9tUmlnaHQuYWRkKHBvaW50KTtcbiAgICB9XG5cbiAgICBtb3ZlVG8ocmVjdDogUmVjdCkge1xuICAgICAgICB0aGlzLnRvcExlZnQueCA9IHJlY3QudG9wTGVmdC54O1xuICAgICAgICB0aGlzLnRvcExlZnQueSA9IHJlY3QudG9wTGVmdC55O1xuICAgICAgICB0aGlzLmJvdHRvbVJpZ2h0LnggPSByZWN0LmJvdHRvbVJpZ2h0Lng7XG4gICAgICAgIHRoaXMuYm90dG9tUmlnaHQueSA9IHJlY3QuYm90dG9tUmlnaHQueTtcbiAgICB9XG5cbiAgICBtb3ZlQ2VudGVyWFRvKGNlbnRlclggOiBudW1iZXIpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBjZW50ZXJYIC0gdGhpcy53aWR0aCgpIC8gMjtcbiAgICAgICAgdmFyIHJpZ2h0ID0gbGVmdCArIHRoaXMud2lkdGgoKTtcbiAgICAgICAgdGhpcy50b3BMZWZ0LnggPSBsZWZ0O1xuICAgICAgICB0aGlzLmJvdHRvbVJpZ2h0LnggPSByaWdodDtcbiAgICB9XG5cbiAgICBtb3ZlQm90dG9tVG8oYm90dG9tOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy50b3BMZWZ0LnkgPSBib3R0b20gLSB0aGlzLmhlaWdodCgpO1xuICAgICAgICB0aGlzLmJvdHRvbVJpZ2h0LnkgPSBib3R0b207IFxuICAgIH1cblxuICAgIHdpZHRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ib3R0b21SaWdodC54IC0gdGhpcy50b3BMZWZ0Lng7XG4gICAgfVxuXG4gICAgaGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ib3R0b21SaWdodC55IC0gdGhpcy50b3BMZWZ0Lnk7XG4gICAgfVxuXG4gICAgY2VudGVyWCgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnRvcExlZnQueCArIHRoaXMuYm90dG9tUmlnaHQueCkgLyAyO1xuICAgIH1cblxuICAgIGNlbnRlclkoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy50b3BMZWZ0LnkgKyB0aGlzLmJvdHRvbVJpZ2h0LnkpIC8gMjtcbiAgICB9XG5cbiAgICBtb3ZlTGVmdChzdGVwOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy50b3BMZWZ0LnggLT0gc3RlcDtcbiAgICAgICAgdGhpcy5ib3R0b21SaWdodC54IC09IHN0ZXA7XG4gICAgfVxuXG4gICAgbW92ZVJpZ2h0KHN0ZXA6IG51bWJlcikge1xuICAgICAgICB0aGlzLnRvcExlZnQueCArPSBzdGVwO1xuICAgICAgICB0aGlzLmJvdHRvbVJpZ2h0LnggKz0gc3RlcDtcbiAgICB9XG59XG5cbmVudW0gU2lkZSB7XG4gICAgTm9uZSxcbiAgICBMZWZ0LFxuICAgIFRvcCxcbiAgICBSaWdodCwgXG4gICAgQm90dG9tXG59XG5cbmNsYXNzIE9ic3RhY2xlIGV4dGVuZHMgUmVjdCB7XG4gICAgY2hlY2tDb2xsaXNpb24oYW5vdGhlclJlY3QgOiBSZWN0KSA6IFNpZGUge1xuICAgICAgICB2YXIgdyA9IDAuNSAqICh0aGlzLndpZHRoKCkgKyBhbm90aGVyUmVjdC53aWR0aCgpKTtcbiAgICAgICAgdmFyIGggPSAwLjUgKiAodGhpcy5oZWlnaHQoKSArIGFub3RoZXJSZWN0LmhlaWdodCgpKTtcbiAgICAgICAgdmFyIGR4ID0gdGhpcy5jZW50ZXJYKCkgLSBhbm90aGVyUmVjdC5jZW50ZXJYKCk7XG4gICAgICAgIHZhciBkeSA9IHRoaXMuY2VudGVyWSgpIC0gYW5vdGhlclJlY3QuY2VudGVyWSgpO1xuXG4gICAgICAgIGlmIChNYXRoLmFicyhkeCkgPD0gdyAmJiBNYXRoLmFicyhkeSkgPD0gaCkge1xuICAgICAgICAgICAgdmFyIHd5ID0gdyAqIGR5O1xuICAgICAgICAgICAgdmFyIGh4ID0gaCAqIGR4O1xuICAgICAgICAgICAgaWYgKHd5ID4gaHgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gd3kgPiAtaHggPyBTaWRlLlRvcCA6IFNpZGUuTGVmdDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHd5ID4gLWh4ID8gU2lkZS5SaWdodCA6IFNpZGUuQm90dG9tO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFNpZGUuTm9uZTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuY2xhc3MgU3ByaXRlIGV4dGVuZHMgT2JzdGFjbGUge1xuICAgIHNwcml0ZTogSFRNTEVsZW1lbnQ7XG4gICAgaXNWaXNpYmxlOiBCb29sZWFuO1xuXG4gICAgY29uc3RydWN0b3Ioc3ByaXRlOiBIVE1MRWxlbWVudCwgbGVmdD8gOiBudW1iZXIsIHRvcD86IG51bWJlciwgcmlnaHQ/OiBudW1iZXIsIGJvdHRvbT86IG51bWJlcikge1xuICAgICAgICBib3R0b20gPSBib3R0b20gfHwgc3ByaXRlLm9mZnNldFRvcCArIHNwcml0ZS5vZmZzZXRIZWlnaHQ7XG4gICAgICAgIHJpZ2h0ID0gcmlnaHQgfHwgc3ByaXRlLm9mZnNldExlZnQgKyBzcHJpdGUub2Zmc2V0V2lkdGg7XG4gICAgICAgIHRvcCA9IHRvcCB8fCBzcHJpdGUub2Zmc2V0VG9wO1xuICAgICAgICBsZWZ0ID0gbGVmdCB8fCBzcHJpdGUub2Zmc2V0TGVmdDtcblxuICAgICAgICBzdXBlcihsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pO1xuICAgICAgICB0aGlzLnNwcml0ZSA9IHNwcml0ZTtcbiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0cnVlO1xuICAgIH1cblxuICAgIG1vdmVUbyhyZWN0IDogUmVjdCkge1xuICAgICAgICBzdXBlci5tb3ZlVG8ocmVjdCk7XG5cbiAgICAgICAgbGV0IHt4OiBwb3NYLCB5OiBwb3NZfSA9IHRoaXMudG9wTGVmdDtcblxuXHQgICAgdGhpcy5zcHJpdGUuc3R5bGUubGVmdCA9IHBvc1ggKyAncHgnO1xuICAgICAgICB0aGlzLnNwcml0ZS5zdHlsZS50b3AgPSBwb3NZICsgJ3B4JzsgICAgICAgICBcbiAgICB9XG5cbiAgICBoaWRlKCkge1xuICAgICAgICB0aGlzLnNwcml0ZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IGZhbHNlO1xuICAgIH0gICAgXG5cbiAgICBzaG93KCkge1xuICAgICAgICB0aGlzLnNwcml0ZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0cnVlO1xuICAgIH0gICAgXG5cbiAgICBjaGVja0NvbGxpc2lvbihhbm90aGVyUmVjdCA6IFJlY3QpIDogU2lkZSB7XG4gICAgICAgIGlmICghdGhpcy5pc1Zpc2libGUpIHtcbiAgICAgICAgICAgIHJldHVybiBTaWRlLk5vbmU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1cGVyLmNoZWNrQ29sbGlzaW9uKGFub3RoZXJSZWN0KTtcbiAgICB9XG59XG5cbmNsYXNzIEJhbGwgZXh0ZW5kcyBTcHJpdGUge1xuXG4gICAgcmFkaXVzIDogbnVtYmVyO1xuICAgIGRpciAgOiBWZWN0b3I7XG4gICAgdmVsb2NpdHk6IG51bWJlcjtcblxuICAgIHdhbGxMZWZ0IDogT2JzdGFjbGU7XG4gICAgd2FsbFRvcDogT2JzdGFjbGU7XG4gICAgd2FsbFJpZ2h0OiBPYnN0YWNsZTtcbiAgICB3YWxsQm90dG9tOiBPYnN0YWNsZTtcblxuICAgIGNvbnN0cnVjdG9yKHNwcml0ZTogSFRNTEVsZW1lbnQsIGRpciA6IFZlY3Rvcikge1xuICAgICAgICB2YXIgcmFkaXVzID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShzcHJpdGUpWydib3JkZXItdG9wLWxlZnQtcmFkaXVzJ10pO1xuICAgICAgICBzdXBlcihzcHJpdGUsIHNwcml0ZS5vZmZzZXRMZWZ0LCBzcHJpdGUub2Zmc2V0VG9wLCBzcHJpdGUub2Zmc2V0TGVmdCArIDIgKiByYWRpdXMsIHNwcml0ZS5vZmZzZXRUb3AgKyAyICogcmFkaXVzKTtcbiAgICAgICAgdGhpcy5zcHJpdGUgPSBzcHJpdGU7XG4gICAgICAgIHRoaXMucmFkaXVzID0gcmFkaXVzO1xuICAgICAgICB0aGlzLnZlbG9jaXR5ID0gNTsgICAgICAgIFxuICAgICAgICB0aGlzLmRpciA9IGRpcjsgICAgICAgIFxuICAgIH1cblxuICAgIGNhbGN1bGF0ZU5ld1Bvc2l0aW9uKCkgOiBSZWN0IHtcbiAgICAgICAgdmFyIG5ld1Bvc2l0aW9uID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBuZXdQb3NpdGlvbi5hZGQodGhpcy5kaXIpO1xuICAgICAgICByZXR1cm4gbmV3UG9zaXRpb247ICAgICAgICBcbiAgICB9XG5cbiAgICBib3VuY2VIb3Jpem9udGFsKCkge1xuICAgICAgICB0aGlzLmRpci5mbGlwWSgpO1xuICAgIH1cblxuICAgIGJvdW5jZVZlcnRpY2FsKCkge1xuICAgICAgICB0aGlzLmRpci5mbGlwWCgpO1xuICAgIH0gXG5cbiAgICBib3VuY2VXaXRoQW5nbGUoYW5nbGU6IG51bWJlcikge1xuICAgICAgICBhbmdsZSA9IGFuZ2xlICogKE1hdGguUEkgLyAxODApO1xuICAgICAgICB0aGlzLmRpci54ID0gTWF0aC5jb3MoYW5nbGUpICogdGhpcy52ZWxvY2l0eTtcbiAgICAgICAgdGhpcy5kaXIueSA9IC1NYXRoLnNpbihhbmdsZSkgKiB0aGlzLnZlbG9jaXR5O1xuICAgIH1cbn1cblxuY2xhc3MgUGFkZGxlIGV4dGVuZHMgU3ByaXRlIHtcbiAgICBjb25zdHJ1Y3RvcihzcHJpdGU6IEhUTUxFbGVtZW50LCBwdWJsaWMgbWF4UmlnaHQgOiBudW1iZXIpIHtcbiAgICAgICAgc3VwZXIoc3ByaXRlKTtcbiAgICB9XG5cbiAgICBtb3ZlTGVmdChzdGVwPzogbnVtYmVyKSB7XG4gICAgICAgIHZhciBuZXdQb3NpdGlvbiA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgbmV3UG9zaXRpb24ubW92ZUxlZnQoc3RlcCk7XG5cbiAgICAgICAgaWYgKG5ld1Bvc2l0aW9uLnRvcExlZnQueCA+PSAwKSB7XG4gICAgICAgICAgICB0aGlzLm1vdmVUbyhuZXdQb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBtb3ZlUmlnaHQoc3RlcD8gOiBudW1iZXIpIHtcbiAgICAgICAgdmFyIG5ld1Bvc2l0aW9uID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBuZXdQb3NpdGlvbi5tb3ZlUmlnaHQoc3RlcCk7XG5cbiAgICAgICAgaWYgKG5ld1Bvc2l0aW9uLmJvdHRvbVJpZ2h0LnggPD0gdGhpcy5tYXhSaWdodCkge1xuICAgICAgICAgICAgdGhpcy5tb3ZlVG8obmV3UG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2FsY3VsYXRlSGl0QW5nbGUoYmFsbFggOiBudW1iZXIsIGJhbGxSYWRpdXMgOiBudW1iZXIpIDogbnVtYmVyIHtcbiAgICAgICAgdmFyIGhpdFNwb3QgPSBiYWxsWCAtIHRoaXMudG9wTGVmdC54O1xuICAgICAgICB2YXIgbWF4UGFkZGxlID0gdGhpcy53aWR0aCgpICsgYmFsbFJhZGl1cztcbiAgICAgICAgdmFyIG1pblBhZGRsZSA9IC1iYWxsUmFkaXVzO1xuICAgICAgICB2YXIgcGFkZGxlUmFuZ2UgPSBtYXhQYWRkbGUgLSBtaW5QYWRkbGU7XG5cbiAgICAgICAgdmFyIG1pbkFuZ2xlID0gMTYwO1xuICAgICAgICB2YXIgbWF4QW5nbGUgPSAyMDtcbiAgICAgICAgdmFyIGFuZ2xlUmFuZ2UgPSBtYXhBbmdsZSAtIG1pbkFuZ2xlO1xuXG4gICAgICAgIHJldHVybiAoKGhpdFNwb3QgKiBhbmdsZVJhbmdlKSAvIHBhZGRsZVJhbmdlKSArIG1pbkFuZ2xlO1xuICAgIH1cbn1cblxuY2xhc3MgQnJpY2sgZXh0ZW5kcyBTcHJpdGUge1xuICAgIGxpZmVMZWZ0OiBudW1iZXIgPSAxO1xufVxuXG5jbGFzcyBEb3VibGVCcmljayBleHRlbmRzIFNwcml0ZSB7XG4gICAgbGlmZUxlZnQ6IG51bWJlciA9IDI7XG5cbiAgICBvbmVMaWZlTGVmdCgpICB7XG4gICAgICAgIHRoaXMuc3ByaXRlLmNsYXNzTGlzdC5yZW1vdmUoJ2RvdWJsZWJyaWNrJyk7XG4gICAgfVxufVxuXG5lbnVtIEdhbWVTdGF0ZSB7XG4gICAgUnVubmluZyxcbiAgICBHYW1lT3ZlclxufVxuXG5lbnVtIEtleUNvZGVzIHtcbiAgICBMRUZUID0gMzcsXG4gICAgUklHSFQgPSAzOVxufVxuXG5jbGFzcyBHYW1lIHtcbiAgICBsb29wSW50ZXJ2YWw6IG51bWJlciA9IDEwO1xuICAgIGdhbWVTdGF0ZTogR2FtZVN0YXRlO1xuICAgIGJhbGw6IEJhbGw7XG4gICAgcGFkZGxlOiBQYWRkbGU7XG4gICAgYnJpY2tzOiBBcnJheTxCcmljaz4gPSBbXTtcblxuICAgIGtleU1hcCA9IHt9O1xuXG4gICAgd2FsbExlZnQgOiBPYnN0YWNsZTtcbiAgICB3YWxsVG9wOiBPYnN0YWNsZTtcbiAgICB3YWxsUmlnaHQ6IE9ic3RhY2xlO1xuICAgIHdhbGxCb3R0b206IE9ic3RhY2xlOyAgICBcblxuICAgIGxpdmVzTGVmdCA6IG51bWJlcjtcbiAgICBzY29yZTogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IoYmFsbEVsZW1lbnQgOiBIVE1MRWxlbWVudCwgcGFkZGxlOiBIVE1MRWxlbWVudCwgYnJpY2tzOiBIVE1MQ29sbGVjdGlvbiwgYm9hcmRFbGVtZW50IDogSFRNTEVsZW1lbnQsIHB1YmxpYyBsaXZlc0xhYmVsIDogSFRNTEVsZW1lbnQsXG4gICAgICAgIHB1YmxpYyBzY29yZUxhYmVsOiBIVE1MRWxlbWVudCwgcHVibGljIG5ld0dhbWVCdG46IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuZ2FtZVN0YXRlID0gR2FtZVN0YXRlLlJ1bm5pbmc7XG4gICAgICAgIHRoaXMucGFkZGxlID0gbmV3IFBhZGRsZShwYWRkbGUsIGJvYXJkRWxlbWVudC5vZmZzZXRXaWR0aCk7XG5cbiAgICAgICAgdGhpcy5iYWxsID0gbmV3IEJhbGwoXG4gICAgICAgICAgICBiYWxsRWxlbWVudCwgICAgICAgICAgICBcbiAgICAgICAgICAgIG5ldyBWZWN0b3IoMywgLTMpIFxuICAgICAgICApO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYnJpY2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZihicmlja3NbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdkb3VibGVicmljaycpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5icmlja3MucHVzaChuZXcgRG91YmxlQnJpY2soPEhUTUxFbGVtZW50PmJyaWNrc1tpXSkpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuYnJpY2tzLnB1c2gobmV3IEJyaWNrKDxIVE1MRWxlbWVudD5icmlja3NbaV0pKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jcmVhdGVXYWxscyh0aGlzLmJhbGwucmFkaXVzLCBib2FyZEVsZW1lbnQub2Zmc2V0V2lkdGgsIGJvYXJkRWxlbWVudC5vZmZzZXRIZWlnaHQpO1xuXG4gICAgICAgIHRoaXMubmV3R2FtZSgpO1xuXG4gICAgICAgIHRoaXMubmV3R2FtZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMubmV3R2FtZSgpKTtcbiAgICB9ICAgIFxuXG4gICAgY3JlYXRlV2FsbHMocmFkaXVzIDogbnVtYmVyLCBtYXhYIDogbnVtYmVyLCBtYXhZIDogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMud2FsbExlZnQgPSBuZXcgT2JzdGFjbGUoLXJhZGl1cywgLXJhZGl1cywgMCwgbWF4WSArIHJhZGl1cyk7XG4gICAgICAgIHRoaXMud2FsbFRvcCA9IG5ldyBPYnN0YWNsZSgtcmFkaXVzLCAtcmFkaXVzLCBtYXhYICsgcmFkaXVzLCAwKTtcbiAgICAgICAgdGhpcy53YWxsUmlnaHQgPSBuZXcgT2JzdGFjbGUobWF4WCwgLXJhZGl1cywgbWF4WCArIHJhZGl1cywgbWF4WSArIHJhZGl1cyk7XG4gICAgICAgIHRoaXMud2FsbEJvdHRvbSA9IG5ldyBPYnN0YWNsZSgtcmFkaXVzLCBtYXhZLCBtYXhYICsgcmFkaXVzLCBtYXhZICsgcmFkaXVzKTsgICAgICAgIFxuICAgIH1cblxuICAgIG5ld0dhbWUoKSB7XG4gICAgICAgIHRoaXMubmV3R2FtZUJ0bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB0aGlzLnNjb3JlID0gMDtcbiAgICAgICAgdGhpcy5saXZlc0xlZnQgPSAzO1xuICAgICAgICB0aGlzLmxpdmVzTGFiZWwuaW5uZXJUZXh0ID0gJycgKyB0aGlzLmxpdmVzTGVmdDtcbiAgICAgICAgdGhpcy5zY29yZSA9IDA7XG4gICAgICAgIHRoaXMuc2NvcmVMYWJlbC5pbm5lclRleHQgPSAnJyArIHRoaXMuc2NvcmU7XG4gICAgICAgIHRoaXMuYmFsbC5zaG93KCk7XG4gICAgICAgIHRoaXMuYmFsbC5ib3VuY2VXaXRoQW5nbGUoNjApO1xuICAgICAgICB2YXIgYmFsbFBvc2l0aW9uID0gdGhpcy5iYWxsLmNsb25lKCk7XG4gICAgICAgIGJhbGxQb3NpdGlvbi5tb3ZlQ2VudGVyWFRvKHRoaXMucGFkZGxlLmNlbnRlclgoKSk7XG4gICAgICAgIGJhbGxQb3NpdGlvbi5tb3ZlQm90dG9tVG8odGhpcy5wYWRkbGUudG9wTGVmdC55IC0gNCk7XG4gICAgICAgIHRoaXMuYmFsbC5tb3ZlVG8oYmFsbFBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5nYW1lU3RhdGUgPSBHYW1lU3RhdGUuUnVubmluZztcbiAgICB9XG5cbiAgICBsb3N0TGl2ZSgpIHtcbiAgICAgICAgaWYgKC0tdGhpcy5saXZlc0xlZnQpIHtcbiAgICAgICAgICAgIHRoaXMuYmFsbC5ib3VuY2VXaXRoQW5nbGUoNjApO1xuICAgICAgICAgICAgdmFyIGJhbGxQb3NpdGlvbiA9IHRoaXMuYmFsbC5jbG9uZSgpO1xuICAgICAgICAgICAgYmFsbFBvc2l0aW9uLm1vdmVDZW50ZXJYVG8odGhpcy5wYWRkbGUuY2VudGVyWCgpKTtcbiAgICAgICAgICAgIGJhbGxQb3NpdGlvbi5tb3ZlQm90dG9tVG8odGhpcy5wYWRkbGUudG9wTGVmdC55IC0gNCk7XG4gICAgICAgICAgICB0aGlzLmJhbGwubW92ZVRvKGJhbGxQb3NpdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZSA9IEdhbWVTdGF0ZS5HYW1lT3ZlcjtcbiAgICAgICAgICAgIHRoaXMuYmFsbC5oaWRlKCk7ICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5uZXdHYW1lQnRuLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOyAgXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5saXZlc0xhYmVsLmlubmVyVGV4dCA9ICcnICsgdGhpcy5saXZlc0xlZnQ7XG4gICAgfVxuXG4gICAgcnVuKCkge1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIChlKSA9PiB0aGlzLmtleU1hcFtlLmtleUNvZGVdID0gZmFsc2UpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHRoaXMua2V5TWFwW2Uua2V5Q29kZV0gPSB0cnVlKTtcblxuICAgICAgIHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdhbWVTdGF0ZSAhPT0gR2FtZVN0YXRlLlJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbmV3QmFsbFBvc2l0aW9uID0gdGhpcy5iYWxsLmNhbGN1bGF0ZU5ld1Bvc2l0aW9uKCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmtleU1hcFtLZXlDb2Rlcy5MRUZUXSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFkZGxlLm1vdmVMZWZ0KDUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmtleU1hcFtLZXlDb2Rlcy5SSUdIVF0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhZGRsZS5tb3ZlUmlnaHQoNSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLndhbGxCb3R0b20uY2hlY2tDb2xsaXNpb24obmV3QmFsbFBvc2l0aW9uKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9zdExpdmUoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLndhbGxMZWZ0LmNoZWNrQ29sbGlzaW9uKG5ld0JhbGxQb3NpdGlvbikgfHwgdGhpcy53YWxsUmlnaHQuY2hlY2tDb2xsaXNpb24obmV3QmFsbFBvc2l0aW9uKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYmFsbC5ib3VuY2VWZXJ0aWNhbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMud2FsbFRvcC5jaGVja0NvbGxpc2lvbihuZXdCYWxsUG9zaXRpb24pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5iYWxsLmJvdW5jZUhvcml6b250YWwoKTtcbiAgICAgICAgICAgIH0gICAgIFxuXG4gICAgICAgICAgICBmb3IgKGxldCBicmljayBvZiB0aGlzLmJyaWNrcykge1xuICAgICAgICAgICAgICAgIGxldCB3YXNIaXQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHN3aXRjaCAoYnJpY2suY2hlY2tDb2xsaXNpb24obmV3QmFsbFBvc2l0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIChTaWRlLkxlZnQpOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIChTaWRlLlJpZ2h0KTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmFsbC5ib3VuY2VWZXJ0aWNhbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2FzSGl0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgKFNpZGUuVG9wKTpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAoU2lkZS5Cb3R0b20pOiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJhbGwuYm91bmNlSG9yaXpvbnRhbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2FzSGl0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAod2FzSGl0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKC0tYnJpY2subGlmZUxlZnQgPCAxKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmljay5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmljay5vbmVMaWZlTGVmdCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjb3JlICs9IDIwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjb3JlTGFiZWwuaW5uZXJUZXh0ID0gJycgKyB0aGlzLnNjb3JlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnBhZGRsZS5jaGVja0NvbGxpc2lvbihuZXdCYWxsUG9zaXRpb24pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5iYWxsLmJvdW5jZVdpdGhBbmdsZSh0aGlzLnBhZGRsZS5jYWxjdWxhdGVIaXRBbmdsZSh0aGlzLmJhbGwuY2VudGVyWCgpLCB0aGlzLmJhbGwucmFkaXVzKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuYmFsbC5tb3ZlVG8odGhpcy5iYWxsLmNhbGN1bGF0ZU5ld1Bvc2l0aW9uKCkpO1xuICAgICAgIH0sIHRoaXMubG9vcEludGVydmFsKSBcbiAgICB9XG59XG5cbmNvbnNvbGUubG9nKCdIZWxsbyBmcm9tIEJyaWNrQnVzdGVyICEhIScpO1xuXG52YXIgZ2FtZSA9IG5ldyBHYW1lKFxuICAgIDxIVE1MRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYmFsbFwiKVswXSxcbiAgICA8SFRNTEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInBhZGRsZVwiKVswXSxcbiAgICA8SFRNTENvbGxlY3Rpb24+ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJyaWNrXCIpLFxuICAgIDxIVE1MRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZ2FtZS1ib2FyZFwiKVswXSxcbiAgICA8SFRNTEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpdmVzJyksXG4gICAgPEhUTUxFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY29yZScpLFxuICAgIDxIVE1MRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3R2FtZScpICAgIFxuKTtcblxuZ2FtZS5ydW4oKTsiXX0=
